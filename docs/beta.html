
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.3.0/dist/tf.min.js"></script>
  </head>
  <body>
    <input type="file" id="input-image">
    <br><br>
    <div id="output"></div>
    
    <script>
      async function loadModel() {
        const model = await tf.loadLayersModel('https://raw.githubusercontent.com/Snipeur060/Yoshi-Ai-recognize/main/docs/model/model.json', {
          metadata: 'https://raw.githubusercontent.com/Snipeur060/Yoshi-Ai-recognize/main/docs/model/metadata.json'
        });
        return model;
      }
      
      async function predict(model, image) {
        // Preprocessing the input image
        const tensor = tf.browser.fromPixels(image).resizeNearestNeighbor([224, 224]).toFloat();
        const offset = tf.scalar(127.5);
        const normalized = tensor.sub(offset).div(offset);
        const expanded = normalized.expandDims();
        
        // Making predictions
        const predictions = await model.predict(expanded).data();
        const index = predictions.indexOf(Math.max(...predictions));
        
        // Showing the predictions
        document.getElementById("output").innerHTML = "La prédiction est: " + index + " avec une probabilité de " + predictions[index];
      }
      
      async function run() {
        const model = await loadModel();
        const inputImage = document.getElementById("input-image").files[0];
        const image = new Image();
        image.src = URL.createObjectURL(inputImage);
        image.onload = () => {
          predict(model, image);
        };
      }
      
      document.getElementById("input-image").addEventListener("change", run);
    </script>
  </body>
</html>
