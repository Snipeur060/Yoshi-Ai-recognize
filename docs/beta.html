
<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.3.0/dist/tf.min.js"></script>
  </head>
  <body>
    <input type="file" id="input-image">
    <br><br>
    <div id="output"></div>
    
    <script>
      async function loadModel() {
        const model = await tf.loadLayersModel('https://raw.githubusercontent.com/Snipeur060/Yoshi-Ai-recognize/main/docs/model/model.json', {
          metadata: 'https://raw.githubusercontent.com/Snipeur060/Yoshi-Ai-recognize/main/docs/model/metadata.json'
        });
        return model;
      }
      
      async function predict(model, image) {
        const imageTensor = tf.browser.fromPixels(image).resizeNearestNeighbor([224,224]).toFloat().expandDims();
        const predictions = await model.predict(imageTensor).data();
        const index = predictions.indexOf(Math.max(...predictions));
        
        // Charger le fichier metadata.json pour obtenir les noms des classes
        const metadata = await (await fetch("https://raw.githubusercontent.com/Snipeur060/Yoshi-Ai-recognize/main/docs/model/metadata.json")).json();
        const className = metadata["output_labels"][index];
        
        document.getElementById("output").innerHTML = "La prédiction est: " + className + " avec une probabilité de " + predictions[index];
      }

      
      async function run() {
        const model = await loadModel();
        const inputImage = document.getElementById("input-image").files[0];
        const image = new Image();
        image.src = URL.createObjectURL(inputImage);
        image.onload = () => {
          predict(model, image);
        };
      }
      
      document.getElementById("input-image").addEventListener("change", run);
    </script>
  </body>
</html>
