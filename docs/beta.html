<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>TensorFlow.js Image Classifier Example</title>
  </head>
  <body>
    <h1>TensorFlow.js Image Classifier Example</h1>
    <p>Upload an image to see the prediction:</p>
    <input type="file" id="input">
    <br><br>
    <img id="img" width="300" />
    <br><br>
    <p id="result"></p>

    <!-- Load TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.0/dist/tf.min.js"></script>
    <script>
      async function run() {
        // Load the model
        const modelURL = 'model/model.json';
        const model = await tf.loadLayersModel(modelURL);

        // Load the input image
        const input = document.getElementById('input');
        const img = document.getElementById('img');
        img.src = URL.createObjectURL(input.files[0]);

        // Pre-process the image
        const image = tf.browser.fromPixels(img);
        const imageResized = tf.image.resizeBilinear(image, [224, 224]);
        const imageNormalized = imageResized.div(255.0);
        const imageExpanded = imageNormalized.expandDims(0);

        // Run the model
        const prediction = model.predict(imageExpanded);
        const scores = prediction.dataSync();

        // Show the result
        const classNames = ['Yoshi', 'Nothing'];
        let index = scores.indexOf(Math.max(...scores));
        document.getElementById('result').innerHTML = `Prediction: ${classNames[index]} (${(scores[index] * 100).toFixed(2)}%)`;
      }
    </script>
    <button onclick="run()">Predict</button>
  </body>
</html>
