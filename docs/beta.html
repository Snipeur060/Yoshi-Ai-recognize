<html>
  <head>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.4.0/dist/tf.min.js"></script>
  </head>
  <body>
    <input type="file" id="image-selector">
    <br><br>
    <div id="prediction"></div>

    <script>
      const imageSelector = document.getElementById('image-selector');
      const predictionDiv = document.getElementById('prediction');

      // Load the model.
      const modelURL = 'model/model.json';
      const model = await tf.loadLayersModel(modelURL);

      // Load the image.
      imageSelector.addEventListener('change', async () => {
        const image = imageSelector.files[0];
        const reader = new FileReader();
        reader.readAsDataURL(image);
        reader.onload = async () => {
          const img = new Image();
          img.src = reader.result;
          img.width = 227;
          img.height = 227;
          document.body.appendChild(img);

          // Predict the image.
          const tensor = tf.browser.fromPixels(img).resizeNearestNeighbor([227, 227]).toFloat().expandDims();
          const predictions = await model.predict(tensor).data();

          // Display the predictions.
          predictionDiv.innerHTML = '';
          for (let i = 0; i < predictions.length; i++) {
            const prediction = predictions[i];
            const predictionPercentage = (prediction * 100).toFixed(2) + '%';
            predictionDiv.innerHTML += `Class ${i}: ${predictionPercentage}<br>`;
          }
        };
      });
    </script>
  </body>
</html>
